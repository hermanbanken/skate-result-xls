{"version":3,"sources":["angular.js","historyTimePlot.js","lapTimePlot.js","loader.js","skaterService.js","skaters.js","skatersCompare.js","skatersResources.js"],"names":[],"mappings":"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","file":"all.js","sourcesContent":["angular.module('skateApp.services', [])\n.factory('Competition', ['$resource', function($resource) {\n\treturn $resource('/api/competitions/:id', null);\n}])\n.factory('CompetitionResult', ['$resource', function($resource) {\n\treturn $resource('/api/competitions/:id/result', null, {\n\t\tget: { method: \"GET\", isArray: true }\n\t});\n}]);\n\nvar app = angular.module('skateApp', [\n\t'ngResource',\n\t'ngRoute',\n\t'ui.router',\n\t'angular.filter',\n\t'skateApp.services'\n])\n.run(function ($rootScope, $state, $stateParams) {\n  $rootScope.$on(\"$stateChangeError\", console.log.bind(console));\n\t// It's very handy to add references to $state and $stateParams to the $rootScope\n\t// so that you can access them from any scope within your applications.\n\t$rootScope.$state = $state;\n\t$rootScope.$stateParams = $stateParams;\n});\n\napp.controller('appCtrl', [\"$scope\", \"$rootScope\", \"$http\", function ($scope, $rootScope, $http) {\n\t\n\t// Filtering\n\t$rootScope.filter = JSON.parse(localStorage.getItem(\"filter\")) || { venue: null, discipline: null };\n\t$scope.doFilter = function(){\n\t\tvar old = JSON.parse(localStorage.getItem(\"filter\")) || {};\n\t\tif(old.discipline != $rootScope.filter.discipline) {\n\t\t\t$rootScope.filter.venue = null;\n\t\t}\n\t\tlocalStorage.setItem(\"filter\", JSON.stringify($rootScope.filter));\n\t}\n\t$scope.doFilter();\n\n}]);\n\napp.config(function($locationProvider, $stateProvider, $urlRouterProvider, $resourceProvider) {\n\t// Fancy HTML5 url's (no hashes).\n\t//$locationProvider.html5Mode( true );\n\t\n\t// Routes\n\tvar root = $stateProvider;\n\t\n\troot.state('competitions', {\n\t\tabstract: true,\n\t\turl: \"/competitions\",\n\t\ttemplate: \"<ui-view />\",\n\t\tresolve: {\n\t\t\tcompetitions: function(Competition){\n\t\t\t\treturn Competition.query().$promise;\n\t\t\t}\n\t\t},\n\t\tonEnter: function($rootScope, competitions){\n\t\t\t// Populate filter lists\n\t\t\t$rootScope.states = [\"Nog niet bekend\", \"Voorlopig resultaat\", \"Resultaat beschikbaar\"];\n\t\t\t$rootScope.venues = _.uniq(_.pluck(competitions, \"venue\"), \"code\").filter(function(a){return a;});\n\t\t}\n\t})\n\t\n\troot.state('competitions.list', {\n\t\turl: \"\",\n\t\ttemplateUrl: 'partials/competitions.html',\n\t\tcontroller: 'CompetitionListCtrl',\n\t})\n\t\n\troot.state('competitions.detail', {\n\t\turl: '/:id',\n\t\ttemplateUrl: 'partials/competition.html',\n\t\tcontroller: 'CompetitionDetailCtrl',\n\t\tresolve: {\n\t\t\tcompetition: function(Competition, $stateParams){\n\t\t\t\treturn Competition.get({ id: $stateParams.id }).$promise;\n\t\t\t},\n\t\t\tresult: function(CompetitionResult, $stateParams){\n\t\t\t\treturn CompetitionResult.get({ id: $stateParams.id }).$promise;\n\t\t\t}\n\t\t}\n\t});\n\n\t$urlRouterProvider.otherwise(\"/competitions\");\n\n\t// Don't strip trailing slashes from calculated URLs\n\t$resourceProvider.defaults.stripTrailingSlashes = false;\n});\n\napp.run(function($rootScope){\n\t$rootScope.$on('$stateChangeStart', function(event, toState, toParams, fromState, fromParams){\n\t\t$(\".page-loading .modal\").modal('show');\n\t});\n\t$rootScope.$on('$stateChangeSuccess', function(event, toState, toParams, fromState, fromParams){\n\t\t$(\".page-loading .modal\").modal('hide');\n\t});\n});\n\n//$('<div class=\"progress\"><div class=\"progress-bar progress-bar-striped active\" role=\"progressbar\" style=\"width: 100%\"></div></div>')\n\t\napp.controller('CompetitionListCtrl', [\"$scope\", \"$rootScope\", \"$http\", \"competitions\", function ($scope, $rootScope, $http, competitions) {\n\t\n\t// Group by availability state\n\t$scope.competitions = _.map(_.groupBy(competitions, function(c) {\n\t\tif(new Date(c.ends) > new Date())\n\t\t\treturn 0;\n\t\treturn c.resultsStatus;\n\t}), function(list, key){\n\t\treturn { state: key, value: list };\n\t});\n\t\n}]);\n\napp.controller('CompetitionDetailCtrl', function ($scope, $state, $stateParams, result, competition, skaterService) {\n\t$scope.result = result.map(function(part) {\n\t\t// Find distinct list of passings distances available in this competition part\n\t\tpart.passings = _.chain(part.results).pluck(\"times\").map(function(ts) { \n\t\t\treturn ts.map(function(t) { return t[0]; });\n\t\t}).flatten().uniq().value();\n\t\treturn part;\n\t});\n\t\n\t// Compute\n\tvar sums = result.map(function(part, index){\n\t\t// Per user an id and a distance\n\t\tvar pilars = part.results.map(function(user){\n\t\t\tvar id = user.name + \":\" + user.category;\n\t\t\tvar last = _.last(user.times);\n\t\t\tvar distance = last[0].replace('m', \"\");\n\t\t\tvar time = last[1];\n\t\t\treturn { id, distance, time };\n\t\t});\n\t\t\n\t\t// Most probable distance\n\t\tvar distance = _.chain(pilars).countBy(\"distance\").value();\n\t\tvar mostHave = _.chain(distance).pairs().max(function(p){ return p[1]; }).value();\n\t\t\n\t\t// Return bucket of [id : index] pairs and probability\n\t\treturn {\n\t\t\tname: part.name, index,\n\t\t\toriginal: part,\n\t\t\tsimple: pilars,\n\t\t\tbuckets: _.chain(pilars).filter(u => u.distance == mostHave[0]).pluck(\"id\").map(function(id){ return { id, index }; }).value(),\n\t\t\tdistance: mostHave[0], certainty: mostHave[1] / part.results.length };\n\t});\n\n\t// Merge buckets and count how many times each distance combinations exists\n\tvar buckets = _.chain(sums).pluck(\"buckets\").flatten().groupBy(\"id\").mapObject(function(list){\n\t\treturn _.pluck(list, \"index\");\n\t}).countBy(function(ds, user){\n\t\treturn ds.join(\"-\");\n\t}).mapObject(function(count, id){\n\t\treturn { count, id };\n\t}).values().value();\n\t\n\t// Find non-overlapping combinations. Warning: complex combinations are thus never returned\n\tvar combinations = _.chain(result).map(function(part, index){\n\t\tvar combination  = _.chain(buckets)\n\t\t\t.filter(function(b){ return b.id.split(\"-\").indexOf(index+\"\") >= 0 })\n\t\t\t.max(function(b){ return b.count; }).value().id;\n\t\treturn combination;\n\t}).uniq().value();\n\t// console.log(competition, combinations);\n\n\t// Calculate points per user\n\tvar ranks = combinations.map(c => {\n\t\tvar distances = c.split(\"-\").map(d => parseInt(d));\n\t\tvar rank = distances.map(i => sums[i]).map((list,listIndex) => {\n\t\t\tvar d = parseInt(list.distance);\n\t\t\treturn list.simple.map(user => ({\n\t\t\t\tid: user.id,\n\t\t\t\tcol: { index: listIndex, distance: list.distance, time: user.time, ok: user.distance == list.distance },\n\t\t\t\tpoints:  (skaterService.parseTime(user.time, true) / d * 500), \n\t\t\t\tok: user.distance == list.distance\n\t\t\t}))\n\t\t});\n\t\trank.distances = distances.map(i => sums[i]).map((list,i) => [i,parseInt(list.distance)]).sort();\n\t\treturn rank;\n\t}).map(rank => {\n\t\tvar output = _.chain(rank).flatten().groupBy(\"id\").pairs().map(pair => {\n\t\t\tvar list = pair[1];\n\t\t\treturn {\n\t\t\t\tname: pair[0].split(\":\")[0],\n\t\t\t\tcategory: pair[0].split(\":\")[1],\n\t\t\t\tcols: _.chain(list).pluck(\"col\").indexBy(\"index\").value(),\n\t\t\t\tpoints: _.chain(list).filter(u => u.ok).pluck(\"points\").reduce((s,n) => s+n, 0).value(),\n\t\t\t\tdistances: list.filter(u => u.ok).length\n\t\t\t}\n\t\t}).value();\n\t\toutput.distances = rank.distances;\n\t\treturn output;\n\t})\n\tconsole.log(ranks);\n\t\n\t// Reload\n\t$scope.refresh = function() {\n\t\tconsole.log(\"Deleting cache of competition\", competition);\n\t\t$scope.result = [];\n\t\t$scope.ranks = [];\n\t\t\n\t\tcompetition.$delete(competition).then(function(){\n\t\t\tconsole.log(\"Reloading competition\", competition.id);\n\t\t\t$state.transitionTo($state.current, $stateParams, {\n\t\t\t\t\treload: true,\n\t\t\t\t\tinherit: false,\n\t\t\t\t\tnotify: true\n\t\t\t});\n\t\t});\n\t};\n\n\t$scope.ranks = ranks;\t\n\t$scope.competition = competition;\n});","app.factory(\"historyTimePlot\", function(skaterService) {\n\n\tfunction parseDate(dateString) {\n\t\treturn new Date(dateString);\n\t}\n\tfunction parseSkateTime(skateTime) {\n\t\tif(skateTime)\n\t\t\treturn skaterService.parseTime(skateTime);\n\t\treturn;\n\t}\n\tfunction formatSkateTime(millis) {\n\t\treturn skaterService.formatTime(millis);\n\t}\n\n\treturn function(data, nodeSelector, labelSelector, titleText) {\n\t\tvar xScale = new Plottable.Scales.Time();\n\t\tvar yScale = new Plottable.Scales.Linear();\n\t\tvar xAxis = new Plottable.Axes.Time(xScale, \"bottom\")\n\t\t\t.margin(5)\n\t\t\t.annotationsEnabled(true);\n\t\tvar yAxis = new Plottable.Axes.Numeric(yScale, \"left\")\n\t\t\t.margin(5).formatter(formatSkateTime);\n\n\t\tvar names = _.chain(data).groupBy(labelSelector).keys().value();\n\n\t\tvar fillColorScale, legend;\n\t\tif(typeof labelSelector == 'function') {\n\t\t\tfillColorScale = new Plottable.Scales.Color().domain(names);\n\t\t\tlegend = new Plottable.Components.Legend(fillColorScale);\n\t\t} else {\n\t\t\tfillColorScale = \"#0052A5\";\n\t\t}\n\n\t\tvar title = new Plottable.Components.TitleLabel(titleText, 0)\n\t\t\t.yAlignment(\"top\");\n\n\t\tvar timeline = new Plottable.Plots.Scatter()\n\t\t\t.x(function(d) { return parseDate(d.date); }, xScale)\n\t\t\t.y(function(d) { return parseSkateTime(d.time); }, yScale)\n\t\t\t.size(10)\n\t\t\t.attr(\"opacity\", 1)\n\t\t\t.attr(\"stroke-width\", 1)\n\t\t\t.attr(\"fill\", labelSelector, fillColorScale)\n\t\t\t.attr(\"stroke\", \"#ffffff\")\n\t\t\t.autorangeMode(\"y\")\n\t\t\n\t\tvar guideline = new Plottable.Components.GuideLineLayer(\"vertical\")\n\t\t\t.scale(xScale);\n\t\t\n\t\tvar group = new Plottable.Components.Group([guideline, timeline, legend, title]);\n\t\tvar table = new Plottable.Components.Table([[yAxis, group],\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[null, xAxis]]);\n\t\ttable.renderTo(nodeSelector);\n\t\t\n\t\tnew Plottable.Interactions.PanZoom(xScale, null)\n\t\t\t.attachTo(timeline)\n\t\t\t.minDomainExtent(xScale, 1000 * 60 * 60 * 24 * 365)\n\t\t\t.maxDomainExtent(xScale, 1000 * 60 * 60 * 24 * 365 * 20);;\n\t\t\n\t\tnew Plottable.Interactions.Pointer()\n\t\t\t.attachTo(table)\n\t\t\t.onPointerMove(function(p) {\n\t\t\t\tvar entity = timeline.entityNearest(p);\n\t\t\t\tvar date = parseDate(entity.datum.date);\n\t\t\t\tguideline.value(date);\n\t\t\t\txAxis.annotatedTicks([date]);\n\t\t\t\ttitle.text(entity.datum.date + \" \" + entity.datum.time);\n\t\t\t})\n\t\t\t.onPointerExit(function() {\n\t\t\t\tguideline.pixelPosition(-10);\n\t\t\t\txAxis.annotatedTicks([]);\n\t\t\t\ttitle.text(\"\");\n\t\t\t});\n\n\t\tvar times = data.map(d => d.time).map(parseSkateTime).sort((a,b) => a-b);\n\t\t// Filter times that are larger than 110% of the 90 percentile time,\n\t\t// to filter races where the skater has fallen\n\t\tvar p_80f1_1 = data.filter((d, i) => parseSkateTime(d.time) < 1.1 * times[Math.floor(times.length * .8)]);\n\n\t\ttimeline.addDataset(new Plottable.Dataset(p_80f1_1));\n\t}\n});","app.factory(\"lapTimePlot\", function(skaterService) {\n\n\tfunction parseDate(dateString) {\n\t\treturn new Date(dateString);\n\t}\n\tfunction parseSkateTime(skateTime) {\n\t\tif(skateTime)\n\t\t\treturn skaterService.parseTime(skateTime);\n\t\treturn;\n\t}\n\tfunction formatSkateTime(millis) {\n\t\treturn skaterService.formatTime(millis);\n\t}\n\n\tfunction lapDistances(distanceString) {\n\t\tvar laps = [], d = parseInt(distanceString);\n\t\twhile(d > 0)\n\t\t\tlaps.unshift(d), d -= 400;\n\t\treturn laps;\t\t\n\t}\n\n\treturn function(data, nodeSelector, labelSelector, titleText) {\n\t\tvar xScale = new Plottable.Scales.Category();\n\t\tvar yScale = new Plottable.Scales.Linear();\n\t\tvar xAxis = new Plottable.Axes.Category(xScale, \"bottom\")\n\t\t\t.margin(5)\n\t\t\t.annotatedTicks(lapDistances(data[0].distance))\n\t\t\t.annotationsEnabled(false);\n\t\tvar yAxis = new Plottable.Axes.Numeric(yScale, \"left\")\n\t\t\t.margin(5).formatter(formatSkateTime);\n\n\t\tvar names = _.chain(data).groupBy(labelSelector).keys().value();\n\n\t\tvar fillColorScale, legend;\n\t\tif(typeof labelSelector == 'function') {\n\t\t\tfillColorScale = new Plottable.Scales.Color().domain(names);\n\t\t\tlegend = new Plottable.Components.Legend(fillColorScale);\n\t\t} else {\n\t\t\tfillColorScale = \"#0052A5\";\n\t\t}\n\n\t\tvar title = new Plottable.Components.TitleLabel(titleText, 0)\n\t\t\t.yAlignment(\"top\");\n\n\t\tvar timeline = new Plottable.Components.Group();\n\n\t\tvar guideline = new Plottable.Components.GuideLineLayer(\"vertical\")\n\t\t\t.scale(xScale);\n\n\t\tvar group = new Plottable.Components.Group([guideline, timeline, legend, title]);\n\t\tvar table = new Plottable.Components.Table([[yAxis, group],\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[null, xAxis]]);\n\t\ttable.renderTo(nodeSelector);\n\n\t\t// var times = data.map(d => d.time).map(parseSkateTime).sort((a,b) => a-b);\n\t\t// // Filter times that are larger than 110% of the 90 percentile time,\n\t\t// // to filter races where the skater has fallen\n\t\t// var p_80f1_1 = data.filter((d, i) => parseSkateTime(d.time) < 1.1 * times[Math.floor(times.length * .8)]);\n\n\t\tvar races = data\n\t\t\t.filter(race => race.laps)\n\t\t\t.filter(race => race.venue != \"NY\")\n\t\t\t.sort((a,b) => a.time.localeCompare(b.time))\n\t\t\t.slice(0, 10);\n\t\t\n\t\tvar bounds = races.map(race => parseSkateTime(race.time)).sort();\n\t\tbounds.splice(1, bounds.length - 2);\n\t\t\n\t\tfunction opacity(d, i) {\n\t\t\tvar t = parseSkateTime(d.time);\n\t\t\tvar o = .2 + .8 * ((bounds[1] - t) / (bounds[1] - bounds[0]));\n\t\t\treturn o;\n\t\t}\n\n\t\traces.forEach(race => {\n\t\t\ttimeline.append(new Plottable.Plots.Line().addDataset(new Plottable.Dataset(race.laps.filter(l => l.lap_time).sort((a,b) => a.distance - b.distance)))\n\t\t\t\t.x(function(d) { return d.distance; }, xScale)\n\t\t\t\t.y(function(d) { return parseSkateTime(d.lap_time); }, yScale)\n\t\t\t\t//.size(10)\n\t\t\t\t.attr(\"opacity\", opacity(race))\n\t\t\t\t.attr(\"stroke-width\", 2)\n\t\t\t\t//.attr(\"fill\", labelSelector, fillColorScale)\n\t\t\t\t.attr(\"stroke\", fillColorScale.scale(0))\n\t\t\t\t// .autorangeMode(\"y\")\n\t\t\t);\n\t\t})\n\t}\n});","app\n\n.factory('Loader', function($q) {\n\treturn function Loader(name) {\n\t\tvar progress = $q.defer();\n\n\t\tfunction loading(fn) {\n\t\t\tvar args = Array.prototype.slice.call(arguments,1);\n\t\t\tfunction notify() {\n\t\t\t\tprogress.notify({\n\t\t\t\t\tname,\n\t\t\t\t\tprogress: (loading.total - loading.counter) / loading.total, \n\t\t\t\t\tcount: loading.counter, total: loading.total,\n\t\t\t\t\tprogress_success: (loading.total - loading.counter - loading.errors) / loading.total,\n\t\t\t\t\tprogress_error: loading.errors / loading.total,\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn $q.when().then(function(){\n\t\t\t\t\tloading.total++;\n\t\t\t\t\tloading.counter++;\n\t\t\t\t\tnotify();\n\t\t\t}).then(function(){\n\t\t\t\t\treturn fn.apply(null, args);\n\t\t\t}).catch(function(e){\n\t\t\t\tloading.errors++;\n\t\t\t\treturn e;\n\t\t\t}).finally(function(){\n\t\t\t\tloading.counter--;\n\t\t\t\tnotify();\n\t\t\t});\n\t\t}\n\n\t\tloading.total = 0;\n\t\tloading.counter = 0;\n\t\tloading.errors = 0;\n\t\tloading.progress = progress.promise;\n\t\t\n\t\tloading.wrap = function(fn) {\n\t\t\tvar args = Array.prototype.slice.call(arguments,1);\n\t\t\tvar d = $q.defer();\n\t\t\tfn.apply(null, args).then(v => d.resolve(v), e => d.reject(e));\n\t\t\tloading.progress.then(null, null, n => d.notify(n));\n\t\t\treturn d.promise;\n\t\t}\n\n\t\treturn loading;\n\t}\n})","// minus 1 for stupid JavaScript dates\nvar MONTH_JUNE = 5;\nvar SEASON = new Date().getFullYear() + (new Date().getMonth() <= MONTH_JUNE ? -1 : 0);\n\nif(!Function.identity) {\n\tFunction.identity = function(id) { return id; };\n}\n\nfunction ageToCategory(age) {\n\tif(age < 7)\n\t\treturn \"PF\";\n\tif(age < 13)\n\t\treturn \"P\" + (\"FEDCBA\"[age - 7]);\n\tif(age < 19)\n\t\treturn (\"CBA\"[(age - 13) / 2]) + ((age - 13) % 2 + 1);\n\tif(age < 23)\n\t\treturn \"N\" + (age - 19 + 1);\n\tif(age < 30)\n\t\treturn \"SA\";\n\tif(age < 39)\n\t\treturn \"SB\";\n\tif(age < 69)\n\t\treturn \"\" + (40 + Math.floor((age - 39) / 5) * 5);\n\n\treturn \"70\";\n}\n\nfunction parseCategory(date, inSeason) {\n\tif(!date)\treturn;\n\tif(!inSeason) inSeason = SEASON;\n\t\n\tvar age = inSeason - date.getFullYear() - (date.getMonth() <= MONTH_JUNE ? 0 : 1);\n\treturn ageToCategory(age);\n}\n\n/**\n * Parse date format to millis\n */\nfunction parseTime(time, isEnglish) {\n\tvar output = 0;\n\tvar multipliers = [1, 1000, 1000 * 60, 1000 * 3600];\n\tvar multi, part, parts = time.split(/[:,\\.]/g);\n\tif(parts[parts.length-1].length == 2) \n\t\tmultipliers[0] = 10;\n\tdo {\n\t\tpart = parts.pop();\n\t\tmulti = multipliers.shift();\n\t\toutput += multi * parseInt(part);\n\t}\n\twhile (parts.length && multipliers.length);\n\treturn output;\n}\n\nfunction pad(num, size) {\n    var s = num+\"\";\n    while (s.length < size) s = \"0\" + s;\n    return s;\n}\n\nfunction formatTime(millis) {\n  var us = millis % 1000,\n      ss = ((millis - us) / 1000) % 60,\n      ms = ((millis - ss * 1000 - us) / 60000) % 60;\n\treturn (ms > 0 ? (ms + \":\") : \"\") + pad(ss,2) + \".\" + pad(us,3).substr(0,2);\n}\n\napp.factory('skaterService', function() {\n\tfunction Skater(data){\n\t\tfor(var key in data) {\n\t\t\tif(key in Skater.prototype) continue;\n\t\t\tif(!data.hasOwnProperty(key)) continue;\n\t\t\tthis[key] = data[key];\n\t\t}\n\t\tif(this.birthdate)\n\t\t\tthis.birthdate = new Date(this.birthdate);\n\t}\n\t\n\tSkater.prototype.category = function(season) {\n\t\tif(!season) season = SEASON;\n\t\tif(!this.birthdate) return \"?\";\n\t\treturn parseCategory(new Date(this.birthdate), season);\n\t};\n\t\n\tSkater.prototype.href = function(link) {\n\t\tswitch(link.type) {\n\t\t\tcase \"ssr\": return \"http://speedskatingresults.com/index.php?p=17&s=:id\".replace(\":id\", link.code);\n\t\t\tcase \"osta\": return \"http://www.osta.nl/?pid=:id\".replace(\":id\", link.code);\n\t\t\tcase \"knsb\":\n\t\t\tdefault: return \"\";\n\t\t}\n\t};\n\t\n\tSkater.prototype.remove = function(){\n\t\tvar i = service.skaters.indexOf(this);\n\t\tif(i >= 0){\n\t\t\tservice.skaters.splice(i, 1);\n\t\t\tservice.save();\n\t\t}\n\t};\n\t\n\tSkater.prototype.equals = function(obj, ignoreBirthdate){\n\t\tvar equal =\n\t\t\tthis.first_name == obj.first_name && \n\t\t\tthis.last_name == obj.last_name &&\n\t\t\t(ignoreBirthdate || (this.birthdate instanceof Date && this.birthdate.getTime()) == (obj.birthdate instanceof Date && obj.birthdate.getTime()))\n\t\treturn equal;\n\t};\n\n\tvar service = {\n\t\tskaters: (JSON.parse(localStorage.getItem(\"skaters\")) || []).map(data => new Skater(data)),\n\t\tsave: function(){\n\t\t\tlocalStorage.setItem(\"skaters\", JSON.stringify(service.skaters));\n\t\t},\n\t\tadd: function(data){\n\t\t\tservice.skaters.push(new Skater(data));\n\t\t},\n\t\tparseTime: parseTime,\n\t\tformatTime: formatTime,\n\t\tageToCategory: ageToCategory\n\t};\n\t\n\tservice.save();\n  return service;\n});","app.config(function($locationProvider, $stateProvider) {\n\t// Router\n\tvar router = $stateProvider;\n\t\n\trouter.state('skaters', {\n\t\turl: '/skaters',\n\t\tviews: {\t\n\t\t\t'': {\n\t\t\t\ttemplateUrl: 'partials/skaters.html',\n\t\t\t\tcontroller: 'SkatersCtrl'\n\t\t\t},\n\t\t\t'compare@skaters': {\n\t\t\t\ttemplateUrl: 'partials/skaters_compare.html',\n\t\t\t\tcontroller: 'SkatersCompareCtrl',\n\t\t\t\tresolve: {}\n\t\t\t}\n\t\t}\n\t});\n\t\n\trouter.state('skater_single', {\n\t\turl: '/skaters/single?first_name&last_name&birthdate',\n\t\tviews: {\n\t\t\t'': {\n\t\t\t\ttemplateUrl: 'partials/skaters_single.html',\n\t\t\t\tcontroller: 'SkatersSingleCtrl',\n\t\t\t\tresolve: {}\n\t\t\t}\n\t\t}\n\t})\n\t\n\trouter.state('skaters.link', {\n\t\turl: '/link?first_name&last_name&birthdate',\n\t\tviews: {\n\t\t\t'modal@': {\n\t\t\t\ttemplateUrl: 'partials/skaters_link.html',\n\t\t\t\tcontroller: 'SkatersLinkCtrl',\n\t\t\t\tresolve: {\n\t\t\t\t\tfindresult: function(SkatersFindResult, $state, $stateParams){\n\t\t\t\t\t\treturn SkatersFindResult.get({\n\t\t\t\t\t\t\tfirst_name: $stateParams.first_name,\n\t\t\t\t\t\t\tlast_name: $stateParams.last_name,\n\t\t\t\t\t\t\tbirthdate: $stateParams.birthdate\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonExit: function(){\n\t\t\t$(\".modal-backdrop\").remove();\n\t\t}\n\t});\n\t\n});\n\napp.controller('SkatersCtrl', function ($scope, $rootScope, $stateParams, skaterService) {\n\t$scope.skaters = skaterService.skaters;\n\t$scope.add_skater = {};\n\t$scope.compare = [];\n\t$rootScope.compared = [];\n\t\n\t$scope.$watch(\"compare\", function(value, old) {\n\t\t$scope.compared = value.map((v,i) => [v,i]).filter(v => v[0]).map(v => v[1]);\n\t}, true);\n\t\n\t// Submit form\n\t$scope.addSkater = function(model){\n\t\tif(model.birthdate) {\n\t\t\tmodel.birthdate = new Date(model.birthdate);\n\t\t}\n\t\tskaterService.add(model);\n\t\t$scope.add_skater = {};\n\t\tskaterService.save();\n\t}\n});\n\napp.controller('SkatersSingleCtrl', function ($scope, $rootScope, $stateParams, skaterService, RaceService, historyTimePlot, lapTimePlot) {\n\t$stateParams.birthdate = new Date($stateParams.birthdate);\n\t$scope.skater = skaterService.skaters.find(skater => skater.equals($stateParams, true));\n\t\n\t$scope.progress = 0;\n\t$scope.times = RaceService.get($scope.skater).then(result => {\n\t\twindow.result = result;\n\t\t[500, 1000, 1500, 3000, 5000, 10000].forEach(distance => {\n\t\t\thistoryTimePlot(result.times.filter(m => m.distance == distance), \".graph[data-type='history'][data-distance='\"+distance+\"']\", match => match.name);\n\t\t\tif(distance != 500)\n\t\t\t\tlapTimePlot(result.times.filter(m => m.distance == distance), \".graph[data-type='laps'][data-distance='\"+distance+\"']\", match => match.name);\n\t\t})\n\t\tconsole.log(\"result\", result);\n\t}, e => {\n\t\tconsole.log(\"error\", e);\n\t}, n => {\n\t\t$scope.progress_success = n.progress_success;\n\t\t$scope.progress_error = n.progress_error;\n\t});\n});\n\napp.controller('SkatersLinkCtrl', function ($scope, $state, $stateParams, skaterService, findresult) {\n\tvar birthdate = $stateParams.birthdate = new Date($stateParams.birthdate);\n\t\n\t$scope.skater = skaterService.skaters.find(skater => skater.equals($stateParams));\n\t$scope.skaters = skaterService.skaters;\n\t\n\t// Fill checkboxes when category matches\n\tfindresult.$promise.then(results => {\n\t\t$scope.results = results.map(result => {\n\t\t\tif(birthdate) {\n\t\t\t\tresult.selected = result.categories.every(c => parseCategory(birthdate, c.season) == c.category.substring(1));\n\t\t\t}\n\t\t\treturn result;\n\t\t})\n\t});\n\t\n\t$scope.saveLinks = function(){\n\t\tvar links = $scope.results.filter(r => r.selected);\n\t\tvar updated = skaterService.skaters.filter(skater => skater.equals($stateParams));\n\t\t\n\t\tif(updated.length == 0 && (!$stateParams.birthdate || isNaN($stateParams.birthdate.getTime()))){\n\t\t\tupdated = skaterService.skaters.filter(skater => skater.equals($stateParams, true));\n\t\t}\n\t\t\n\t\tupdated.forEach(skater => { skater.ids = links; });\n\t\tskaterService.save();\n\t\t\n\t\tif(updated.length != 1)\n\t\t\talert(\"Something unexpected happened. Sorry :(\");\n\t\telse\n\t\t\t$state.go(\"^\");\n\t};\n\t\n\t$('.modal').modal({}).on('hidden.bs.modal', function (e) {\n\t\t$state.go('^');\n\t});\n});","app.controller('SkatersCompareCtrl', function ($scope, $state, $stateParams, skaterService) {\n\n//\t$rootScope.compared = [];\n\tconsole.log(\"Compare now!\");\n\n});\n\napp.filter('withIndexes', function() {\n  return function(input, indexes) {\n\t\treturn input.filter(function(v, k) {\n\t\t\treturn indexes.indexOf(k) >= 0;\n\t\t});\n  };\n});","if(typeof Array.prototype.flatMap != 'function')\nArray.prototype.flatMap = function(selector) {\n\treturn this.map(selector).reduce(function (memo, list) { \n\t\tmemo.push.apply(memo, list); \n\t\treturn memo;\n\t}, []);\n};\n\napp\n\n.factory('SkatersFindResult', ['$resource', function($resource) {\n\treturn $resource('/api/skaters/find', null, {\n\t\tget: { method: \"GET\", isArray: true }\n\t});\n}])\n\n.factory('RaceTime', function($resource) {\n\treturn $resource('/api/skaters/:type/:code', null);\n})\n\n.factory('RaceService', function($q, RaceTime, $resource, Loader) {\n\t\n\tfunction scopedGet(input) {\n\t\tvar loading = Loader(\"races\")\n\t\t\n\t\t// !Scoped Functions!\n\t\n\t\tfunction combine(one, multiple) {\n\t\t\treturn { \n\t\t\t\ttimes: (one && one.times || []).concat(multiple.flatMap(s => s.times)), \n\t\t\t\terrors: (one && one.errors || []).concat(multiple.flatMap(s => s.errors))\n\t\t\t};\n\t\t}\n\t\t\n\t\tfunction fetch(url) {\n\t\t\treturn loading(() => $resource(url).get().$promise)\n\t\t\t\t.then(recurse, (error) => {\n\t\t\t\t\treturn $q.resolve({ times: [], errors: [error.data] });\n\t\t\t\t});\n\t\t}\n\t\t\n\t\tfunction recurse(data) {\n\t\t\tvar deferred = $q.defer();\n\t\t\t// If we have more\n\t\t\tif(Array.isArray(data.more)) {\n\t\t\t\treturn $q\n\t\t\t\t\t.all(data.more.map(fetch))\n\t\t\t\t\t.then(subs => combine(data, subs));\n\t\t\t}\n\t\t\t// No more\n\t\t\telse {\n\t\t\t\tdeferred.resolve({ times: data.times, errors: [] });\n\t\t\t}\n\t\t\t\n\t\t\treturn deferred.promise;\n\t\t}\n\t\t\n\t\tfunction mergeSources(data) {\n\t\t\tdata.times = _\n\t\t\t\t.chain(data.times)\n\t\t\t\t// Join by day - might be not good enough\n\t\t\t\t.groupBy(m => m.date + \"|\" + m.distance + \"|\" + m.time)\n\t\t\t\t// Merge\n\t\t\t\t.map(t => _.extend.bind(_, {}).apply(_, t))\n\t\t\t\t.sortBy(m => m.date)\n\t\t\t\t.value();\n\t\t\treturn data;\n\t\t}\n\t\n\t\t// !Actual processing!\n\t\t\n\t\tfunction get(input) {\n\t\t\t// Skater\n\t\t\tif(input.ids) {\n\t\t\t\treturn $q\n\t\t\t\t\t.all(input.ids.map(get))\n\t\t\t\t\t.then(list => combine(null, list))\n\t\t\t\t\t.then(mergeSources);\n\t\t\t}\n\t\t\t\n\t\t\tif(!input.type || !input.code)\n\t\t\t\treturn $q.reject(new Error(input, \"is is not a linkable id\"));\n\t\t\t\n\t\t\t// Linkable service\n\t\t\treturn loading(() => RaceTime.get({ type: input.type, code: input.code }).$promise)\n\t\t\t\t.then(recurse);\n\t\t}\n\t\t\n\t\t// Wrap so this promise notifies progress\n\t\treturn loading.wrap(get, input);\n\t}\n\n\treturn {\n\t\tget: scopedGet\n\t};\n\n});"],"sourceRoot":"/source/"}